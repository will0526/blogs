#启动优化

## APP 启动时都干了些什么事

APP启动分为冷启动和热启动，冷启动即从点击图标到系统创建一个进程分配给他的情况。热启动即从后台进入前台的过程。


* main函数执行前

    * 加载可执行文件（APP的.o文件集合）
    
    * 加载动态链接库，进行rebase 指针调整和bind符合绑定
    
    * oc 运行时初始化处理，包括OC相关类的注册、category注册、selector唯一性检查
    
    * 初始化，包括执行 +load（）方法、attribute（）修饰的函数调用、创建C++ 静态全局变量
    
对于优化可做的事情：
    
   1，减少动态库加载。建议最多使用6个非系统动态库，使用动态库多的时候，尽量将动态库合并
   
   2，减少加载启动后不会去使用的类或者方法
   
   3，+load()方法里的内容可以放到首屏渲染后再执行，或使用initialize方法替换掉。
   在+load方法里，进行运行时方法替换操作会带来4毫秒的消耗。
   
   4，控制C++ 全局变量的数量
   

* main 函数执行后

main函数执行后的阶段，指的是从main函数执行开始，到AppDelegate的 didFinishLaunchingWithOptions 方法里首屏渲染相关方法执行完成。

很多时候开发者会把各种初始化工作都放到这个阶段执行，想要优化的话，需要从业务上进行梳理。将这些初始化功能分别放到合适的阶段进行。


* 首屏渲染完成后


其他模块的初始化工作。
然后就可以从功能级别的和方法级别的启动优化。


功能级别：
    
从业务上其他非首屏相关的业务的初始化，监听注册，配置文读取等都放到首屏渲染完成后去做。

方法级别：

检查首屏渲染完成前，在主线程上有哪些耗时方法，将没必要的耗时方法滞后或者异步执行。




#